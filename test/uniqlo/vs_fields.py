# coding:UTF-8

import json

insight="""{"channel": "tmall_o2o_detail", "fileType": "PARQUERT", "fields": [{"type": "STRING", "name": "\u8ba2\u5355\u53f7", "fieldName": "DW_TMALL_O2O_DETAIL_ORDER_NO"}, {"type": "STRING", "name": "\u8ba2\u5355\u660e\u7ec6\u53f7", "fieldName": "DW_TMALL_O2O_DETAIL_ORDER_LINE_NO"}, {"type": "STRING", "name": "\u53d1\u8d27\u65e5\u671f", "fieldName": "DW_TMALL_O2O_DETAIL_DELIVER_DATE"}, {"type": "STRING", "name": "\u5546\u54c1ID", "fieldName": "DW_TMALL_O2O_DETAIL_PLU"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_DETAIL_ORIG_ITEM_CD"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_DETAIL_ORIG_ITEM_NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_DETAIL_ORIG_SKU_PROP_1"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_DETAIL_ORIG_SKU_PROP_2"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_DETAIL_REQ_QTY"}, {"type": "STRING", "name": "\u6570\u91cf", "fieldName": "DW_TMALL_O2O_DETAIL_QTY"}, {"type": "STRING", "name": "\u539f\u4ef7", "fieldName": "DW_TMALL_O2O_DETAIL_ORIG_PRICE"}, {"type": "STRING", "name": "\u6dd8\u5b9d\u4ef7\u683c", "fieldName": "DW_TMALL_O2O_DETAIL_TB_PRICE"}, {"type": "STRING", "name": "\u6298\u6263\u540e\u4ef7\u683c", "fieldName": "DW_TMALL_O2O_DETAIL_DISCOUNT_PRICE"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_DETAIL_INBOUND_DATE"}, {"type": "STRING", "name": "\u4e1a\u52a1\u5904\u7406\u65f6\u95f4", "fieldName": "DW_TMALL_O2O_DETAIL_BIZ_DATE"}, {"type": "STRING", "name": "ETL\u52a0\u5de5\u65f6\u95f4", "fieldName": "DW_TMALL_O2O_DETAIL_ETL_DATE"}, {"type": "STRING", "name": "\u76f8\u5bf9SFTP\uff0c\u6587\u4ef6\u5168\u8def\u5f84", "fieldName": "DW_TMALL_O2O_DETAIL_ETL_FILE_PATH"}, {"type": "STRING", "name": "\u76f8\u5bf9\u4e8e\u6e90CSV\u7684\u884c\u53f7", "fieldName": "DW_TMALL_O2O_DETAIL_ETL_FILE_LINE_NO"}, {"type": "STRING", "name": "\u5546\u54c1ID", "fieldName": "DW_PRODUCT_PLU"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_DEPT:CODE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_DEPT:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_GDEPT:CODE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_GDEPT:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CLASS:CODE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CLASS:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_SUBCLASS:CODE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_SUBCLASS:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_SUM:CODE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_SUM:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_ITEM:CODE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_ITEM:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_ITEM:DESC"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_SKULIST"}, {"type": "STRING", "name": "\u989c\u8272", "fieldName": "DW_PRODUCT_COLOR:CODE"}, {"type": "STRING", "name": "\u989c\u8272\u540d\u79f0", "fieldName": "DW_PRODUCT_COLOR:NAME"}, {"type": "STRING", "name": "\u5c3a\u7801", "fieldName": "DW_PRODUCT_SIZE:CODE"}, {"type": "STRING", "name": "\u5c3a\u7801\u540d\u79f0", "fieldName": "DW_PRODUCT_SIZE:NAME"}, {"type": "STRING", "name": "\u56fe\u6848", "fieldName": "DW_PRODUCT_PATTERN:CODE"}, {"type": "STRING", "name": "\u56fe\u6848\u540d\u79f0", "fieldName": "DW_PRODUCT_PATTERN:NAME"}, {"type": "STRING", "name": "\u5e74\u4efd", "fieldName": "DW_PRODUCT_YEAR"}, {"type": "STRING", "name": "\u5b63\u8282KEY", "fieldName": "DW_PRODUCT_SEASON:KEY"}, {"type": "STRING", "name": "\u5b63\u8282CD", "fieldName": "DW_PRODUCT_SEASON:CODE"}, {"type": "STRING", "name": "\u5b63\u8282\u540d\u79f0", "fieldName": "DW_PRODUCT_SEASON:VALUE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CSN"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_FR_ASRT_CD"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_PACK:SUPP_SIZE"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_PACK:INNER_SIZE"}, {"type": "STRING", "name": "\u4e0a\u5e02\u4ef7\u683c", "fieldName": "DW_PRODUCT_RETAIL:ORIGINAL_PRICE"}, {"type": "STRING", "name": "\u6253\u6298\u540e\u4ef7\u683c", "fieldName": "DW_PRODUCT_RETAIL:DISCOUNT_PRICE"}, {"type": "STRING", "name": "\u6570\u636e\u66f4\u65b0\u7684\u65f6\u95f4\u6233", "fieldName": "DW_PRODUCT_OUTPUT_DATE"}, {"type": "STRING", "name": "CSV\u6587\u4ef6\u5904\u7406\u65f6\u95f4", "fieldName": "DW_PRODUCT_INBOUND_DATE"}, {"type": "STRING", "name": "\u4e1a\u52a1\u5904\u7406\u65f6\u95f4", "fieldName": "DW_PRODUCT_BIZ_DATE"}, {"type": "STRING", "name": "ETL\u52a0\u5de5\u65f6\u95f4", "fieldName": "DW_PRODUCT_ETL_DATE"}, {"type": "STRING", "name": "\u76f8\u5bf9SFTP\uff0c\u6587\u4ef6\u5168\u8def\u5f84", "fieldName": "DW_PRODUCT_ETL_FILE_PATH"}, {"type": "STRING", "name": "\u76f8\u5bf9\u4e8e\u6e90CSV\u7684\u884c\u53f7", "fieldName": "DW_PRODUCT_ETL_FILE_LINE_NO"}, {"type": "STRING", "name": "\u54c1\u756aCD", "fieldName": "DW_PRODUCT_CATEGORY_ITEM_CD"}, {"type": "STRING", "name": "\u5b63\u8282\u7f16\u7801", "fieldName": "DW_PRODUCT_CATEGORY_SEASON_CD"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CATEGORY_CORE_CATEGORY:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CATEGORY_CORE_CATEGORY:COUNT"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CATEGORY_SUB_CATEGORY:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CATEGORY_SUB_CATEGORY:COUNT"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CATEGORY_SUB_CATEGORY2:NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_PRODUCT_CATEGORY_SUB_CATEGORY2:COUNT"}, {"type": "STRING", "name": "\u4e1a\u52a1\u5904\u7406\u65f6\u95f4", "fieldName": "DW_PRODUCT_CATEGORY_BIZ_DATE"}, {"type": "STRING", "name": "ETL\u52a0\u5de5\u65f6\u95f4", "fieldName": "DW_PRODUCT_CATEGORY_ETL_DATE"}, {"type": "STRING", "name": "\u76f8\u5bf9SFTP\uff0c\u6587\u4ef6\u5168\u8def\u5f84", "fieldName": "DW_PRODUCT_CATEGORY_ETL_FILE_PATH"}, {"type": "STRING", "name": "\u76f8\u5bf9\u4e8e\u6e90CSV\u7684\u884c\u53f7", "fieldName": "DW_PRODUCT_CATEGORY_ETL_FILE_LINE_NO"}, {"type": "STRING", "name": "\u8ba2\u5355\u53f7", "fieldName": "DW_TMALL_O2O_HEAD_ORDER_NO"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_HEAD_SHIPPING_TYPE"}, {"type": "STRING", "name": "\u5e97\u94faID", "fieldName": "DW_TMALL_O2O_HEAD_STORE:ID"}, {"type": "STRING", "name": "\u5e97\u94faGlobal_ID", "fieldName": "DW_TMALL_O2O_HEAD_STORE:GLOBAL_ID"}, {"type": "STRING", "name": "\u5e97\u94fa\u540d\u79f0", "fieldName": "DW_TMALL_O2O_HEAD_STORE:NAME"}, {"type": "STRING", "name": "\u8ba2\u5355\u7c7b\u578bKEY", "fieldName": "DW_TMALL_O2O_HEAD_ORDER_TYPE:KEY"}, {"type": "STRING", "name": "\u8ba2\u5355\u7c7b\u578b\u540d\u79f0", "fieldName": "DW_TMALL_O2O_HEAD_ORDER_TYPE:VALUE"}, {"type": "STRING", "name": "\u5929\u732b\u8ba2\u5355\u53f7", "fieldName": "DW_TMALL_O2O_HEAD_TB_ORDER_NO"}, {"type": "STRING", "name": "\u4e0b\u5355\u65e5\u671f", "fieldName": "DW_TMALL_O2O_HEAD_ORDER_DATE"}, {"type": "STRING", "name": "\u4ed8\u6b3e\u65e5\u671f", "fieldName": "DW_TMALL_O2O_HEAD_PAY_DATE"}, {"type": "STRING", "name": "\u53d1\u8d27\u65e5\u671f", "fieldName": "DW_TMALL_O2O_HEAD_DELIVER_DATE"}, {"type": "STRING", "name": "\u5feb\u9012\u540d\u79f0", "fieldName": "DW_TMALL_O2O_HEAD_EXPRESS_NAME"}, {"type": "STRING", "name": "\u5feb\u9012\u5355\u53f7", "fieldName": "DW_TMALL_O2O_HEAD_EXPRESS_NO"}, {"type": "STRING", "name": "\u6dd8\u5b9d\u7528\u6237\u540d", "fieldName": "DW_TMALL_O2O_HEAD_TB_USER_NO"}, {"type": "STRING", "name": "\u963f\u91cc\u652f\u4ed8\u7528\u6237ID", "fieldName": "DW_TMALL_O2O_HEAD_ALIPAY_USER_ID"}, {"type": "STRING", "name": "\u4f1a\u5458ID", "fieldName": "DW_TMALL_O2O_HEAD_MEMBER_ID"}, {"type": "STRING", "name": "\u6536\u8d27\u4eba", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:USER_NAME"}, {"type": "STRING", "name": "\u7701", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:PROVINCE"}, {"type": "STRING", "name": "\u5e02/\u53bf", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:CITY"}, {"type": "STRING", "name": "\u533a/\u9547/", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:DISTRICT"}, {"type": "STRING", "name": "\u5b8c\u6574\u5730\u5740", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:ADDRESS"}, {"type": "STRING", "name": "\u90ae\u7f16", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:ZIP"}, {"type": "STRING", "name": "\u6536\u8d27\u4eba\u7535\u8bdd", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:PHONE"}, {"type": "STRING", "name": "\u6536\u8d27\u4eba\u624b\u673a", "fieldName": "DW_TMALL_O2O_HEAD_CONSIGNEE:MOBILE"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_HEAD_GOODS_FEE"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_HEAD_FREIGHT_FEE"}, {"type": "STRING", "name": "\u603b\u91d1\u989d", "fieldName": "DW_TMALL_O2O_HEAD_TOTAL_AMT"}, {"type": "STRING", "name": "", "fieldName": "DW_TMALL_O2O_HEAD_INBOUND_DATE"}, {"type": "STRING", "name": "\u4e1a\u52a1\u5904\u7406\u65f6\u95f4", "fieldName": "DW_TMALL_O2O_HEAD_BIZ_DATE"}, {"type": "STRING", "name": "ETL\u52a0\u5de5\u65f6\u95f4", "fieldName": "DW_TMALL_O2O_HEAD_ETL_DATE"}, {"type": "STRING", "name": "\u76f8\u5bf9SFTP\uff0c\u6587\u4ef6\u5168\u8def\u5f84", "fieldName": "DW_TMALL_O2O_HEAD_ETL_FILE_PATH"}, {"type": "STRING", "name": "\u76f8\u5bf9\u4e8e\u6e90CSV\u7684\u884c\u53f7", "fieldName": "DW_TMALL_O2O_HEAD_ETL_FILE_LINE_NO"}, {"type": "STRING", "name": "\u4f1a\u5458ID", "fieldName": "DW_MEMBER_MEMBER_ID"}, {"type": "STRING", "name": "\u624b\u673a\u53f7\u7801", "fieldName": "DW_MEMBER_MOBILE_NO"}, {"type": "STRING", "name": "\u59d3\u540d", "fieldName": "DW_MEMBER_NAME"}, {"type": "STRING", "name": "\u751f\u65e5", "fieldName": "DW_MEMBER_BIRTHDAY"}, {"type": "STRING", "name": "\u6027\u522bKEY", "fieldName": "DW_MEMBER_SEX:KEY"}, {"type": "STRING", "name": "\u6027\u522bCD", "fieldName": "DW_MEMBER_SEX:CODE"}, {"type": "STRING", "name": "\u6027\u522b\u540d\u79f0", "fieldName": "DW_MEMBER_SEX:VALUE"}, {"type": "STRING", "name": "\u7701", "fieldName": "DW_MEMBER_LOCATION:PROVINCE"}, {"type": "STRING", "name": "\u5e02", "fieldName": "DW_MEMBER_LOCATION:CITY"}, {"type": "STRING", "name": "\u533a", "fieldName": "DW_MEMBER_LOCATION:DISTRICT"}, {"type": "STRING", "name": "\u8be6\u7ec6\u5730\u5740", "fieldName": "DW_MEMBER_LOCATION:ADDRESS"}, {"type": "STRING", "name": "", "fieldName": "DW_MEMBER_CLIENT_KEY"}, {"type": "STRING", "name": "\u4f1a\u5458\u6765\u6e90\u6e20\u9053ID", "fieldName": "DW_MEMBER_DATA_SOURCE:CHANNEL_ID"}, {"type": "STRING", "name": "\u4f1a\u5458\u6765\u6e90\u6e20\u9053\u540d\u79f0", "fieldName": "DW_MEMBER_DATA_SOURCE:CHANNEL_NAME"}, {"type": "STRING", "name": "\u4f1a\u5458\u6765\u6e90\u6e20\u9053\u6e90", "fieldName": "DW_MEMBER_DATA_SOURCE:CHANNEL_SOURCE"}, {"type": "STRING", "name": "\u5fae\u4fe1UNION_ID", "fieldName": "DW_MEMBER_WECHAT:UNION_ID"}, {"type": "STRING", "name": "\u5fae\u4fe1\u7528\u6237\u540d", "fieldName": "DW_MEMBER_WECHAT:NICK_NAME"}, {"type": "STRING", "name": "EPAY\u7528\u6237ID", "fieldName": "DW_MEMBER_WECHAT:EPAY_USER_ID"}, {"type": "STRING", "name": "\u5fae\u4fe1\u8054\u540d\u4f1a\u5458\u5361ID", "fieldName": "DW_MEMBER_WECHAT:MCARD_ID"}, {"type": "STRING", "name": "\u5fae\u4fe1\u8054\u540d\u4f1a\u5458\u5361\u521b\u5efa\u65e5\u65f6", "fieldName": "DW_MEMBER_WECHAT:MCARD_CREATE_TIME"}, {"type": "STRING", "name": "\u5fae\u4fe1\u8054\u540d\u4f1a\u5458\u5361\u6765\u6e90\u6e20\u9053ID", "fieldName": "DW_MEMBER_WECHAT:MCARD_CHANNEL_ID"}, {"type": "STRING", "name": "\u5fae\u4fe1\u8054\u540d\u4f1a\u5458\u5361\u6765\u6e90\u6e20\u9053\u540d\u79f0", "fieldName": "DW_MEMBER_WECHAT:MCARD_CHANNEL_NAME"}, {"type": "STRING", "name": "\u5fae\u4fe1\u8054\u540d\u4f1a\u5458\u5361\u6765\u6e90\u6e20\u9053\u6e90", "fieldName": "DW_MEMBER_WECHAT:MCARD_CHANNEL_SOURCE"}, {"type": "STRING", "name": "\u652f\u4ed8\u5b9d\u7528\u6237ID", "fieldName": "DW_MEMBER_ALIPAY:USER_ID"}, {"type": "STRING", "name": "\u963f\u91cc\u8054\u540d\u4f1a\u5458\u5361ID", "fieldName": "DW_MEMBER_ALIPAY:MCARD_ID"}, {"type": "STRING", "name": "\u963f\u91cc\u8054\u540d\u4f1a\u5458\u5361\u521b\u5efa\u65e5\u65f6", "fieldName": "DW_MEMBER_ALIPAY:MCARD_CREATE_TIME"}, {"type": "STRING", "name": "\u963f\u91cc\u8054\u540d\u4f1a\u5458\u5361\u6765\u6e90\u6e20\u9053ID", "fieldName": "DW_MEMBER_ALIPAY:MCARD_CHANNEL_ID"}, {"type": "STRING", "name": "\u963f\u91cc\u8054\u540d\u4f1a\u5458\u5361\u6765\u6e90\u6e20\u9053\u540d\u79f0", "fieldName": "DW_MEMBER_ALIPAY:MCARD_CHANNEL_NAME"}, {"type": "STRING", "name": "\u963f\u91cc\u8054\u540d\u4f1a\u5458\u5361\u6765\u6e90\u6e20\u9053\u6e90", "fieldName": "DW_MEMBER_ALIPAY:MCARD_CHANNEL_SOURCE"}, {"type": "STRING", "name": "\u6dd8\u5b9d\u7528\u6237ID", "fieldName": "DW_MEMBER_TAOBAO:USER_ID"}, {"type": "STRING", "name": "\u6dd8\u5b9d\u7528\u6237\u540d", "fieldName": "DW_MEMBER_TAOBAO:NICK_NAME"}, {"type": "STRING", "name": "QQ\u7528\u6237ID", "fieldName": "DW_MEMBER_QQ:USER_ID"}, {"type": "STRING", "name": "QQ\u7528\u6237\u540d", "fieldName": "DW_MEMBER_QQ:NICK_NAME"}, {"type": "STRING", "name": "\u521b\u5efa\u65e5\u65f6", "fieldName": "DW_MEMBER_CREATE_TIME"}, {"type": "STRING", "name": "\u66f4\u65b0\u65e5\u65f6", "fieldName": "DW_MEMBER_UPDATE_TIME"}, {"type": "STRING", "name": "\u4e1a\u52a1\u5904\u7406\u65f6\u95f4", "fieldName": "DW_MEMBER_BIZ_DATE"}, {"type": "STRING", "name": "ETL\u52a0\u5de5\u65f6\u95f4", "fieldName": "DW_MEMBER_ETL_DATE"}, {"type": "STRING", "name": "\u76f8\u5bf9SFTP\uff0c\u6587\u4ef6\u5168\u8def\u5f84", "fieldName": "DW_MEMBER_ETL_FILE_PATH"}, {"type": "STRING", "name": "\u76f8\u5bf9\u4e8e\u6e90CSV\u7684\u884c\u53f7", "fieldName": "DW_MEMBER_ETL_FILE_LINE_NO"}, {"type": "STRING", "name": "\u672c\u5730\u5e97\u94faID", "fieldName": "DW_STORE_STORE_ID"}, {"type": "STRING", "name": "6\u4f4d\u5e97\u94faID", "fieldName": "DW_STORE_STORE_GLOBAL_ID"}, {"type": "STRING", "name": "\u5e97\u94fa\u540d\u79f0", "fieldName": "DW_STORE_STORE_NAME"}, {"type": "STRING", "name": "\u5927\u533a\u540d\u79f0", "fieldName": "DW_STORE_REGION"}, {"type": "STRING", "name": "\u7701\u4efd\u540d\u79f0", "fieldName": "DW_STORE_LOCATION:PROVINCE"}, {"type": "STRING", "name": "\u57ce\u5e02\u540d\u79f0", "fieldName": "DW_STORE_LOCATION:CITY"}, {"type": "STRING", "name": "\u533a\u5757CD", "fieldName": "DW_STORE_BLOCK:CODE"}, {"type": "STRING", "name": "\u533a\u5757\u540d\u79f0", "fieldName": "DW_STORE_BLOCK:NAME"}, {"type": "STRING", "name": "\u533a\u5757\u8d1f\u8d23\u4eba\u59d3\u540d", "fieldName": "DW_STORE_BLOCK:SV_NAME"}, {"type": "STRING", "name": "\u533a\u57dfCD", "fieldName": "DW_STORE_AREA:CODE"}, {"type": "STRING", "name": "\u533a\u57df\u540d\u79f0", "fieldName": "DW_STORE_AREA:NAME"}, {"type": "STRING", "name": "\u533a\u57df\u8d1f\u8d23\u4eba\u59d3\u540d", "fieldName": "DW_STORE_AREA:SV_NAME"}, {"type": "STRING", "name": "", "fieldName": "DW_STORE_MAIN_WH"}, {"type": "STRING", "name": "\u4e1a\u52a1\u5904\u7406\u65f6\u95f4", "fieldName": "DW_STORE_BIZ_DATE"}, {"type": "STRING", "name": "ETL\u52a0\u5de5\u65f6\u95f4", "fieldName": "DW_STORE_ETL_DATE"}, {"type": "STRING", "name": "\u76f8\u5bf9SFTP\uff0c\u6587\u4ef6\u5168\u8def\u5f84", "fieldName": "DW_STORE_ETL_FILE_PATH"}, {"type": "STRING", "name": "\u76f8\u5bf9\u4e8e\u6e90CSV\u7684\u884c\u53f7", "fieldName": "DW_STORE_ETL_FILE_LINE_NO"}]}
"""

dw="""DW_TMALL_O2O_DETAIL.ORDER_NO as DW_TMALL_O2O_DETAIL_ORDER_NO, DW_TMALL_O2O_DETAIL.ORDER_LINE_NO as DW_TMALL_O2O_DETAIL_ORDER_LINE_NO, DW_TMALL_O2O_DETAIL.DELIVER_DATE as DW_TMALL_O2O_DETAIL_DELIVER_DATE, DW_TMALL_O2O_DETAIL.PLU as DW_TMALL_O2O_DETAIL_PLU, DW_TMALL_O2O_DETAIL.ORIG_ITEM_CD as DW_TMALL_O2O_DETAIL_ORIG_ITEM_CD, DW_TMALL_O2O_DETAIL.ORIG_ITEM_NAME as DW_TMALL_O2O_DETAIL_ORIG_ITEM_NAME, DW_TMALL_O2O_DETAIL.ORIG_SKU_PROP_1 as DW_TMALL_O2O_DETAIL_ORIG_SKU_PROP_1, DW_TMALL_O2O_DETAIL.ORIG_SKU_PROP_2 as DW_TMALL_O2O_DETAIL_ORIG_SKU_PROP_2, DW_TMALL_O2O_DETAIL.REQ_QTY as DW_TMALL_O2O_DETAIL_REQ_QTY, DW_TMALL_O2O_DETAIL.QTY as DW_TMALL_O2O_DETAIL_QTY, DW_TMALL_O2O_DETAIL.ORIG_PRICE as DW_TMALL_O2O_DETAIL_ORIG_PRICE, DW_TMALL_O2O_DETAIL.TB_PRICE as DW_TMALL_O2O_DETAIL_TB_PRICE, DW_TMALL_O2O_DETAIL.DISCOUNT_PRICE as DW_TMALL_O2O_DETAIL_DISCOUNT_PRICE, DW_TMALL_O2O_DETAIL.INBOUND_DATE as DW_TMALL_O2O_DETAIL_INBOUND_DATE, DW_TMALL_O2O_DETAIL.BIZ_DATE as BIZ_DATE, DW_TMALL_O2O_DETAIL.ETL_DATE as DW_TMALL_O2O_DETAIL_ETL_DATE, DW_TMALL_O2O_DETAIL.ETL_FILE_PATH as DW_TMALL_O2O_DETAIL_ETL_FILE_PATH, DW_TMALL_O2O_DETAIL.ETL_FILE_LINE_NO as DW_TMALL_O2O_DETAIL_ETL_FILE_LINE_NO, DW_TMALL_O2O_HEAD.ORDER_NO as DW_TMALL_O2O_HEAD_ORDER_NO, DW_TMALL_O2O_HEAD.SHIPPING_TYPE as DW_TMALL_O2O_HEAD_SHIPPING_TYPE, DW_TMALL_O2O_HEAD.STORE as DW_TMALL_O2O_HEAD_STORE, DW_TMALL_O2O_HEAD.ORDER_TYPE as DW_TMALL_O2O_HEAD_ORDER_TYPE, DW_TMALL_O2O_HEAD.TB_ORDER_NO as DW_TMALL_O2O_HEAD_TB_ORDER_NO, DW_TMALL_O2O_HEAD.ORDER_DATE as DW_TMALL_O2O_HEAD_ORDER_DATE, DW_TMALL_O2O_HEAD.PAY_DATE as DW_TMALL_O2O_HEAD_PAY_DATE, DW_TMALL_O2O_HEAD.DELIVER_DATE as DW_TMALL_O2O_HEAD_DELIVER_DATE, DW_TMALL_O2O_HEAD.EXPRESS_NAME as DW_TMALL_O2O_HEAD_EXPRESS_NAME, DW_TMALL_O2O_HEAD.EXPRESS_NO as DW_TMALL_O2O_HEAD_EXPRESS_NO, DW_TMALL_O2O_HEAD.TB_USER_NO as DW_TMALL_O2O_HEAD_TB_USER_NO, DW_TMALL_O2O_HEAD.ALIPAY_USER_ID as DW_TMALL_O2O_HEAD_ALIPAY_USER_ID, DW_TMALL_O2O_HEAD.MEMBER_ID as DW_TMALL_O2O_HEAD_MEMBER_ID, DW_TMALL_O2O_HEAD.CONSIGNEE as DW_TMALL_O2O_HEAD_CONSIGNEE, DW_TMALL_O2O_HEAD.GOODS_FEE as DW_TMALL_O2O_HEAD_GOODS_FEE, DW_TMALL_O2O_HEAD.FREIGHT_FEE as DW_TMALL_O2O_HEAD_FREIGHT_FEE, DW_TMALL_O2O_HEAD.TOTAL_AMT as DW_TMALL_O2O_HEAD_TOTAL_AMT, DW_TMALL_O2O_HEAD.INBOUND_DATE as DW_TMALL_O2O_HEAD_INBOUND_DATE, DW_TMALL_O2O_HEAD.BIZ_DATE as DW_TMALL_O2O_HEAD_BIZ_DATE, DW_TMALL_O2O_HEAD.ETL_DATE as DW_TMALL_O2O_HEAD_ETL_DATE, DW_TMALL_O2O_HEAD.ETL_FILE_PATH as DW_TMALL_O2O_HEAD_ETL_FILE_PATH, DW_TMALL_O2O_HEAD.ETL_FILE_LINE_NO as DW_TMALL_O2O_HEAD_ETL_FILE_LINE_NO, DW_MEMBER.MEMBER_ID as DW_MEMBER_MEMBER_ID, DW_MEMBER.MOBILE_NO as DW_MEMBER_MOBILE_NO, DW_MEMBER.NAME as DW_MEMBER_NAME, DW_MEMBER.BIRTHDAY as DW_MEMBER_BIRTHDAY, DW_MEMBER.SEX as DW_MEMBER_SEX, DW_MEMBER.LOCATION as DW_MEMBER_LOCATION, DW_MEMBER.CLIENT_KEY as DW_MEMBER_CLIENT_KEY, DW_MEMBER.DATA_SOURCE as DW_MEMBER_DATA_SOURCE, DW_MEMBER.WECHAT as DW_MEMBER_WECHAT, DW_MEMBER.ALIPAY as DW_MEMBER_ALIPAY, DW_MEMBER.TAOBAO as DW_MEMBER_TAOBAO, DW_MEMBER.QQ as DW_MEMBER_QQ, DW_MEMBER.CREATE_TIME as DW_MEMBER_CREATE_TIME, DW_MEMBER.UPDATE_TIME as DW_MEMBER_UPDATE_TIME, DW_MEMBER.BIZ_DATE as DW_MEMBER_BIZ_DATE, DW_MEMBER.ETL_DATE as DW_MEMBER_ETL_DATE, DW_MEMBER.ETL_FILE_PATH as DW_MEMBER_ETL_FILE_PATH, DW_MEMBER.ETL_FILE_LINE_NO as DW_MEMBER_ETL_FILE_LINE_NO, DW_PRODUCT.PLU as DW_PRODUCT_PLU, DW_PRODUCT.DEPT as DW_PRODUCT_DEPT, DW_PRODUCT.GDEPT as DW_PRODUCT_GDEPT, DW_PRODUCT.CLASS as DW_PRODUCT_CLASS, DW_PRODUCT.SUBCLASS as DW_PRODUCT_SUBCLASS, DW_PRODUCT.SUM as DW_PRODUCT_SUM, DW_PRODUCT.ITEM as DW_PRODUCT_ITEM, DW_PRODUCT.SKULIST as DW_PRODUCT_SKULIST, DW_PRODUCT.COLOR as DW_PRODUCT_COLOR, DW_PRODUCT.SIZE as DW_PRODUCT_SIZE, DW_PRODUCT.PATTERN as DW_PRODUCT_PATTERN, DW_PRODUCT.YEAR as DW_PRODUCT_YEAR, DW_PRODUCT.SEASON as DW_PRODUCT_SEASON, DW_PRODUCT.CSN as DW_PRODUCT_CSN, DW_PRODUCT.FR_ASRT_CD as DW_PRODUCT_FR_ASRT_CD, DW_PRODUCT.PACK as DW_PRODUCT_PACK, DW_PRODUCT.RETAIL as DW_PRODUCT_RETAIL, DW_PRODUCT.OUTPUT_DATE as DW_PRODUCT_OUTPUT_DATE, DW_PRODUCT.INBOUND_DATE as DW_PRODUCT_INBOUND_DATE, DW_PRODUCT.BIZ_DATE as DW_PRODUCT_BIZ_DATE, DW_PRODUCT.ETL_DATE as DW_PRODUCT_ETL_DATE, DW_PRODUCT.ETL_FILE_PATH as DW_PRODUCT_ETL_FILE_PATH, DW_PRODUCT.ETL_FILE_LINE_NO as DW_PRODUCT_ETL_FILE_LINE_NO, DW_PRODUCT_CATEGORY.ITEM_CD as DW_PRODUCT_CATEGORY_ITEM_CD, DW_PRODUCT_CATEGORY.SEASON_CD as DW_PRODUCT_CATEGORY_SEASON_CD, DW_PRODUCT_CATEGORY.CORE_CATEGORY as DW_PRODUCT_CATEGORY_CORE_CATEGORY, DW_PRODUCT_CATEGORY.SUB_CATEGORY as DW_PRODUCT_CATEGORY_SUB_CATEGORY, DW_PRODUCT_CATEGORY.SUB_CATEGORY2 as DW_PRODUCT_CATEGORY_SUB_CATEGORY2, DW_PRODUCT_CATEGORY.BIZ_DATE as DW_PRODUCT_CATEGORY_BIZ_DATE, DW_PRODUCT_CATEGORY.ETL_DATE as DW_PRODUCT_CATEGORY_ETL_DATE, DW_PRODUCT_CATEGORY.ETL_FILE_PATH as DW_PRODUCT_CATEGORY_ETL_FILE_PATH, DW_PRODUCT_CATEGORY.ETL_FILE_LINE_NO as DW_PRODUCT_CATEGORY_ETL_FILE_LINE_NO, DW_STORE.STORE_ID as DW_STORE_STORE_ID, DW_STORE.STORE_GLOBAL_ID as DW_STORE_STORE_GLOBAL_ID, DW_STORE.STORE_NAME as DW_STORE_STORE_NAME, DW_STORE.REGION as DW_STORE_REGION, DW_STORE.LOCATION as DW_STORE_LOCATION, DW_STORE.BLOCK as DW_STORE_BLOCK, DW_STORE.AREA as DW_STORE_AREA, DW_STORE.MAIN_WH as DW_STORE_MAIN_WH, DW_STORE.BIZ_DATE as DW_STORE_BIZ_DATE, DW_STORE.ETL_DATE as DW_STORE_ETL_DATE, DW_STORE.ETL_FILE_PATH as DW_STORE_ETL_FILE_PATH, DW_STORE.ETL_FILE_LINE_NO as DW_STORE_ETL_FILE_LINE_NO
"""

dws=set()

for f in dw.split(","):
    key = f.split("as")[1].strip()
    dws.add(key)

insight_json = json.loads(insight)
fields = insight_json.get("fields")

insights_fields=set()

for ff in fields:
    strip = ff.get("fieldName").strip()
    insights_fields.add(strip)

print(dws)

insights_fields=set(map(lambda x:x.split(":")[0],insights_fields))

print(insights_fields)

#{'DW_TMALL_HEAD_CONSIGNEE', 'DW_TMALL_HEAD_TB_USER_NO', 'DW_TMALL_HEAD_TOTAL_AMT', 'DW_TMALL_HEAD_BIZ_DATE', 'DW_TMALL_HEAD_ETL_FILE_PATH', 'DW_TMALL_HEAD_DELIVER_DATE', 'DW_TMALL_HEAD_ORDER_NO', 'DW_TMALL_HEAD_EXPRESS_NO', 'DW_TMALL_HEAD_ORDER_TYPE', 'DW_TMALL_HEAD_PAY_DATE', 'DW_TMALL_HEAD_MEMBER_ID', 'DW_TMALL_HEAD_EXPRESS_NAME', 'DW_TMALL_HEAD_GOODS_FEE', 'DW_TMALL_HEAD_TB_ORDER_NO', 'DW_TMALL_HEAD_FREIGHT_FEE', 'DW_TMALL_HEAD_ALIPAY_USER_ID', 'DW_TMALL_HEAD_ORDER_DATE', 'DW_TMALL_HEAD_ETL_DATE', 'DW_TMALL_HEAD_INBOUND_DATE'}
print(dws.difference(insights_fields))

print(insight_json)


